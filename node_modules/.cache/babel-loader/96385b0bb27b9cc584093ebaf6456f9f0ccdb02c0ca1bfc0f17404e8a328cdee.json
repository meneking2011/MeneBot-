{"ast":null,"code":"import _objectSpread from\"/workspaces/MeneBot-/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncIterator from\"/workspaces/MeneBot-/node_modules/@babel/runtime/helpers/esm/asyncIterator.js\";import React,{useState,useEffect,useRef,useCallback}from\"react\";import{v4 as uuidv4}from'uuid';import{initializeApp}from'firebase/app';import{getAuth,signInAnonymously,onAuthStateChanged}from'firebase/auth';import{getFirestore,collection,query,onSnapshot,addDoc,orderBy,limit,serverTimestamp,setLogLevel,doc,deleteDoc,writeBatch,getDocs,setDoc}from'firebase/firestore';// --- CONFIGURATION FOR GITHUB DEPLOYMENT ---\n// This configuration is hardcoded as environment variables are not available on GitHub Pages.\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const FIREBASE_CONFIG={apiKey:\"AIzaSyACbU7QPgmUkvn1cmIIytlUK8FI0xBHhmE\",authDomain:\"mene-bot.firebaseapp.com\",projectId:\"mene-bot\",storageBucket:\"mene-bot.firebasestorage.app\",messagingSenderId:\"535679609146\",appId:\"1:535679609146:web:750fcd7b478d93bcae8803\",measurementId:\"G-Q7ET9SGXB8\"};// Use the Firebase Project ID as the logical application identifier for Firestore paths\nconst APP_ID=FIREBASE_CONFIG.projectId;// Use the API key provided in the original fallback\nconst GEMINI_API_KEY='AIzaSyD0fDB4XPYTSONxvbLTUCLznwzLWWV11ys';// --- API and TTS/STT Helper Functions ---\nconst MODEL_NAME='gemini-2.5-flash-preview-09-2025';const API_ENDPOINT=\"https://generativelanguage.googleapis.com/v1beta/models/\".concat(MODEL_NAME,\":generateContent?key=\").concat(GEMINI_API_KEY);const TTS_API_ENDPOINT=\"https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-tts:generateContent?key=\".concat(GEMINI_API_KEY);/**\n * Creates an Async Iterator that handles the AI request and simulates a stream.\n */function askAIStream(inputText,chatHistory){let fullResponse=null;let chunks=[];let chunkIndex=0;const historyForAPI=chatHistory.map(msg=>({role:msg.sender==='user'?'user':'model',parts:[{text:msg.text}]}));// Manually implements the async iterator protocol\nreturn{async next(){try{// First call: make the REST API request\nif(fullResponse===null){var _data$candidates,_data$candidates$,_data$candidates$$con,_data$candidates$$con2,_data$candidates$$con3;const payload={contents:[...historyForAPI,{role:'user',parts:[{text:inputText}]}],systemInstruction:{parts:[{text:\"You are Mene, a helpful and friendly AI assistant. Keep your responses concise.\"}]}};const response=await fetch(API_ENDPOINT,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});if(!response.ok){var _errorDetails$error;const errorDetails=await response.json();throw new Error(\"\".concat(response.status,\" \").concat(response.statusText,\": \").concat(((_errorDetails$error=errorDetails.error)===null||_errorDetails$error===void 0?void 0:_errorDetails$error.message)||'Unknown API Error'));}const data=await response.json();fullResponse=((_data$candidates=data.candidates)===null||_data$candidates===void 0?void 0:(_data$candidates$=_data$candidates[0])===null||_data$candidates$===void 0?void 0:(_data$candidates$$con=_data$candidates$.content)===null||_data$candidates$$con===void 0?void 0:(_data$candidates$$con2=_data$candidates$$con.parts)===null||_data$candidates$$con2===void 0?void 0:(_data$candidates$$con3=_data$candidates$$con2[0])===null||_data$candidates$$con3===void 0?void 0:_data$candidates$$con3.text)||\"No response received from AI.\";// Split the full response to simulate the streaming effect\nchunks=fullResponse.split(/(\\s+)/).filter(c=>c.length>0);}// Subsequent calls: Stream out the chunks one by one\nif(chunkIndex>=chunks.length){return{done:true,value:fullResponse};}await new Promise(r=>setTimeout(r,0));const chunk=chunks[chunkIndex++];return{value:chunk,done:false};}catch(error){console.error(\"Gemini API Error:\",error);return{value:\"ERROR: Failed to connect to AI. Details: \".concat(error.message),done:true};}},[Symbol.asyncIterator](){return this;}};}/**\n * Converts a base64 string to an ArrayBuffer.\n */const base64ToArrayBuffer=base64=>{const binaryString=atob(base64);const len=binaryString.length;const bytes=new Uint8Array(len);for(let i=0;i<len;i++){bytes[i]=binaryString.charCodeAt(i);}return bytes.buffer;};/**\n * Writes a string to a DataView at a specified offset.\n */const writeString=(view,offset,string)=>{for(let i=0;i<string.length;i++){view.setUint8(offset+i,string.charCodeAt(i));}};/**\n * Converts PCM (raw audio data) to a standard WAV format Blob.\n */const pcmToWav=(pcm16,sampleRate)=>{const numChannels=1;const numSamples=pcm16.length;const byteRate=sampleRate*numChannels*2;const blockAlign=numChannels*2;const buffer=new ArrayBuffer(44+pcm16.byteLength);const view=new DataView(buffer);// RIFF header\nwriteString(view,0,'RIFF');view.setUint32(4,36+pcm16.byteLength,true);writeString(view,8,'WAVE');// fmt sub-chunk\nwriteString(view,12,'fmt ');view.setUint32(16,16,true);view.setUint16(20,1,true);// Audio format 1 (PCM)\nview.setUint16(22,numChannels,true);view.setUint32(24,sampleRate,true);view.setUint32(28,byteRate,true);view.setUint16(32,blockAlign,true);view.setUint16(34,16,true);// Bits per sample\n// data sub-chunk\nwriteString(view,36,'data');view.setUint32(40,pcm16.byteLength,true);// PCM data\nconst pcmView=new Int16Array(buffer,44);pcmView.set(pcm16);return new Blob([buffer],{type:'audio/wav'});};/**\n * Makes the TTS API call and returns an Audio URL.\n */const ttsApiCall=async(text,setErrorMessage)=>{if(!text)return null;try{var _result$candidates,_result$candidates$,_result$candidates$$c,_result$candidates$$c2,_part$inlineData,_part$inlineData2;const payload={contents:[{parts:[{text:text}]}],generationConfig:{responseModalities:[\"AUDIO\"],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:\"Achird\"}}}}};const response=await fetch(TTS_API_ENDPOINT,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});if(!response.ok){throw new Error(\"TTS API failed with status \".concat(response.status));}const result=await response.json();const part=result===null||result===void 0?void 0:(_result$candidates=result.candidates)===null||_result$candidates===void 0?void 0:(_result$candidates$=_result$candidates[0])===null||_result$candidates$===void 0?void 0:(_result$candidates$$c=_result$candidates$.content)===null||_result$candidates$$c===void 0?void 0:(_result$candidates$$c2=_result$candidates$$c.parts)===null||_result$candidates$$c2===void 0?void 0:_result$candidates$$c2[0];const audioData=part===null||part===void 0?void 0:(_part$inlineData=part.inlineData)===null||_part$inlineData===void 0?void 0:_part$inlineData.data;const mimeType=part===null||part===void 0?void 0:(_part$inlineData2=part.inlineData)===null||_part$inlineData2===void 0?void 0:_part$inlineData2.mimeType;if(audioData&&mimeType&&mimeType.startsWith(\"audio/L16\")){const rateMatch=mimeType.match(/rate=(\\d+)/);const sampleRate=rateMatch?parseInt(rateMatch[1],10):24000;const pcmData=base64ToArrayBuffer(audioData);const pcm16=new Int16Array(pcmData);const wavBlob=pcmToWav(pcm16,sampleRate);return URL.createObjectURL(wavBlob);}else{setErrorMessage(\"TTS Error: Could not generate valid audio data.\");return null;}}catch(error){console.error(\"TTS Fetch Error:\",error);setErrorMessage(\"TTS Generation failed: \".concat(error.message));return null;}};// --- Firestore Collection Paths (using private user data model) ---\nconst SESSIONS_COLLECTION_PATH=\"/artifacts/\".concat(APP_ID,\"/users\");const MESSAGES_COLLECTION_PATH=(userId,sessionId)=>\"/artifacts/\".concat(APP_ID,\"/users/\").concat(userId,\"/sessions/\").concat(sessionId,\"/messages\");// --- UI Components (Defined locally for single-file mandate) ---\nconst Sidebar=/*#__PURE__*/React.memo(_ref=>{let{sessions,currentSessionId,switchSession,createNewSession,deleteSession,userId}=_ref;const displayUserId=userId?\"\".concat(userId.substring(0,8),\"...\"):\"N/A\";return/*#__PURE__*/_jsxs(\"div\",{className:\"w-full md:w-64 bg-gray-50 border-r border-gray-200 p-4 flex flex-col transition-all duration-300\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-xl font-bold text-gray-800 mb-4 flex items-center justify-between\",children:[\"Conversations\",/*#__PURE__*/_jsx(\"button\",{onClick:createNewSession,className:\"p-2 bg-green-500 text-white rounded-full hover:bg-green-600 transition duration-150 shadow-md\",title:\"New Chat\",children:/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-5 w-5\",viewBox:\"0 0 20 20\",fill:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z\",clipRule:\"evenodd\"})})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 overflow-y-auto space-y-2\",children:sessions.map(session=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-3 rounded-lg cursor-pointer transition duration-150 \".concat(session.id===currentSessionId?'bg-green-100 text-green-700 font-semibold':'bg-white text-gray-700 hover:bg-gray-100'),onClick:()=>switchSession(session.id),children:[/*#__PURE__*/_jsx(\"span\",{className:\"truncate flex-1\",children:session.name||\"New Chat\"}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();deleteSession(session.id);},className:\"text-red-500 p-1 hover:text-red-700 rounded-full transition duration-150 ml-2\",title:\"Delete Chat\",children:/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-4 w-4\",viewBox:\"0 0 20 20\",fill:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 100 2v6a1 1 0 100-2V8z\",clipRule:\"evenodd\"})})})]},session.id))}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 pt-4 border-t border-gray-200 text-sm text-gray-500\",children:[\"User ID: \",/*#__PURE__*/_jsx(\"span\",{className:\"font-mono text-xs\",children:displayUserId})]})]});});// --- Main App Component ---\nexport default function App(){// --- Firebase State ---\nconst[db,setDb]=useState(null);const[auth,setAuth]=useState(null);const[userId,setUserId]=useState(null);const[isAuthReady,setIsAuthReady]=useState(false);const[sessions,setSessions]=useState([]);const[currentSessionId,setCurrentSessionId]=useState(null);// --- Chat State ---\nconst[messages,setMessages]=useState([]);const[input,setInput]=useState(\"\");const[isTyping,setIsTyping]=useState(false);const[errorMessage,setErrorMessage]=useState(null);const messageEndRef=useRef(null);const[isSidebarOpen,setIsSidebarOpen]=useState(window.innerWidth>=768);// --- TTS/STT State ---\nconst[canSpeak,setCanSpeak]=useState(false);const[isListening,setIsListening]=useState(false);const[lastBotMessage,setLastBotMessage]=useState(null);const recognitionRef=useRef(null);// 1. Initialize Firebase and Authentication\nuseEffect(()=>{try{const app=initializeApp(FIREBASE_CONFIG);const firestore=getFirestore(app);const authentication=getAuth(app);setLogLevel('debug');setDb(firestore);setAuth(authentication);const unsubscribeAuth=onAuthStateChanged(authentication,async user=>{var _authentication$curre;if(!user){console.log(\"No user signed in. Attempting anonymous sign-in...\");try{// Use anonymous sign-in for GitHub Pages deployment\nawait signInAnonymously(authentication);}catch(e){console.error(\"Firebase Auth Error:\",e);setErrorMessage(\"Failed to authenticate with Firebase.\");}}setUserId(((_authentication$curre=authentication.currentUser)===null||_authentication$curre===void 0?void 0:_authentication$curre.uid)||crypto.randomUUID());setIsAuthReady(true);});return()=>unsubscribeAuth();}catch(e){console.error(\"Firebase Init Error:\",e);setErrorMessage(\"Failed to initialize Firebase services.\");}},[]);// Empty dependency array, runs once\n// 2. Setup Sessions Listener\nconst createSession=useCallback(async()=>{if(!db||!userId)return;try{const userSessionsRef=collection(db,SESSIONS_COLLECTION_PATH,userId,'sessions');const newDocRef=doc(userSessionsRef);const placeholderName=\"Chat \".concat(sessions.length+1);await setDoc(newDocRef,{name:placeholderName,createdAt:serverTimestamp()});setCurrentSessionId(newDocRef.id);if(window.innerWidth<768){setIsSidebarOpen(false);}}catch(e){console.error(\"Error creating new session:\",e);setErrorMessage(\"Failed to create a new session.\");}},[db,userId,sessions.length]);useEffect(()=>{if(!isAuthReady||!db||!userId)return;const userSessionsRef=collection(db,SESSIONS_COLLECTION_PATH,userId,'sessions');const q=query(userSessionsRef,orderBy('createdAt','desc'));const unsubscribe=onSnapshot(q,snapshot=>{const loadedSessions=snapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));setSessions(loadedSessions);if(loadedSessions.length===0){setTimeout(()=>createSession(),0);}else if(!currentSessionId||!loadedSessions.find(s=>s.id===currentSessionId)){setCurrentSessionId(loadedSessions[0].id);}},error=>{console.error(\"Firestore Sessions Error:\",error);setErrorMessage(\"Failed to fetch chat sessions.\");});return()=>unsubscribe();},[isAuthReady,db,userId,currentSessionId,createSession]);// 3. Setup Messages Listener (Current Session)\nuseEffect(()=>{if(!isAuthReady||!db||!userId||!currentSessionId){setMessages([]);return;}const messagesRef=collection(db,MESSAGES_COLLECTION_PATH(userId,currentSessionId));const q=query(messagesRef,orderBy('createdAt','asc'),limit(50));const unsubscribe=onSnapshot(q,snapshot=>{const loadedMessages=snapshot.docs.map(doc=>{var _data$createdAt;const data=doc.data();return{id:doc.id,sender:data.sender,text:data.text,createdAt:(_data$createdAt=data.createdAt)!==null&&_data$createdAt!==void 0&&_data$createdAt.toDate?data.createdAt.toDate():new Date()};});setMessages(loadedMessages);const lastBot=loadedMessages.slice().reverse().find(msg=>msg.sender==='bot');setLastBotMessage(lastBot);},error=>{console.error(\"Firestore Messages Error:\",error);setErrorMessage(\"Failed to fetch chat messages.\");});return()=>unsubscribe();},[isAuthReady,db,userId,currentSessionId]);// 4. Scroll to bottom on new messages/typing\nuseEffect(()=>{var _messageEndRef$curren;(_messageEndRef$curren=messageEndRef.current)===null||_messageEndRef$curren===void 0?void 0:_messageEndRef$curren.scrollIntoView({behavior:\"smooth\"});},[messages,isTyping]);// 5. Check for TTS/STT capability and setup STT\nuseEffect(()=>{if('speechSynthesis'in window&&'webkitSpeechRecognition'in window){setCanSpeak(true);}if('webkitSpeechRecognition'in window){const recognitionInstance=new window.webkitSpeechRecognition();recognitionInstance.continuous=false;recognitionInstance.interimResults=false;recognitionInstance.lang='en-US';recognitionInstance.onend=()=>setIsListening(false);recognitionInstance.onerror=event=>{console.error('Speech recognition error:',event.error);setErrorMessage(\"Speech recognition error: \".concat(event.error));setIsListening(false);};recognitionRef.current=recognitionInstance;}return()=>{if(recognitionRef.current){recognitionRef.current.stop();recognitionRef.current=null;}};},[]);// --- Firebase Actions ---\nconst switchSession=useCallback(sessionId=>{setCurrentSessionId(sessionId);if(window.innerWidth<768){setIsSidebarOpen(false);}},[]);const deleteSession=async sessionId=>{if(!db||!userId)return;// Use a custom UI component for confirmation instead of window.confirm\nif(!window.confirm(\"Are you sure you want to delete this chat session and all its messages?\")){return;}try{const sessionDocRef=doc(db,SESSIONS_COLLECTION_PATH,userId,'sessions',sessionId);const messagesRef=collection(db,MESSAGES_COLLECTION_PATH(userId,sessionId));const batch=writeBatch(db);const messageDocs=await getDocs(messagesRef);messageDocs.forEach(msgDoc=>{batch.delete(msgDoc.ref);});batch.delete(sessionDocRef);await batch.commit();// Logic to switch to a new session after deletion\nif(currentSessionId===sessionId){const remainingSessions=sessions.filter(s=>s.id!==sessionId);if(remainingSessions.length>0){setCurrentSessionId(remainingSessions[0].id);}else{setCurrentSessionId(null);setTimeout(()=>createSession(),100);}}}catch(e){console.error(\"Error deleting session:\",e);setErrorMessage(\"Failed to delete the chat session.\");}};// --- TTS/STT Handlers ---\nconst handleSpeak=useCallback(async text=>{if(!canSpeak||!text)return;setErrorMessage(null);const audioUrl=await ttsApiCall(text,setErrorMessage);if(audioUrl){const audio=new Audio(audioUrl);audio.play();}},[canSpeak]);const saveMessage=async(sender,text)=>{if(!db||!userId||!currentSessionId||!text)return;try{const messagesRef=collection(db,MESSAGES_COLLECTION_PATH(userId,currentSessionId));await addDoc(messagesRef,{sender:sender,text:text,createdAt:serverTimestamp()});}catch(e){console.error(\"Error saving message:\",e);setErrorMessage(\"Failed to save message to database.\");}};const handleSend=useCallback(async function(){let transcript=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;const textToSend=(transcript||input).trim();if(isTyping||!textToSend||!currentSessionId)return;setErrorMessage(null);setIsTyping(true);setInput(\"\");await saveMessage(\"user\",textToSend);let accumulatedBotText=\"\";const historyForAI=messages.map(msg=>({sender:msg.sender,text:msg.text}));const stream=askAIStream(textToSend,historyForAI);const tempBotId=uuidv4();// Add a temporary message placeholder to trigger scroll and show typing state\nsetMessages(prev=>[...prev,{id:tempBotId,sender:\"bot\",text:\"\"}]);var _iteratorAbruptCompletion=false;var _didIteratorError=false;var _iteratorError;try{for(var _iterator=_asyncIterator(stream),_step;_iteratorAbruptCompletion=!(_step=await _iterator.next()).done;_iteratorAbruptCompletion=false){const chunk=_step.value;{accumulatedBotText+=chunk;setMessages(prev=>prev.map(msg=>msg.id===tempBotId?_objectSpread(_objectSpread({},msg),{},{text:accumulatedBotText}):msg));if(accumulatedBotText.includes(\"ERROR:\"))break;}}}catch(err){_didIteratorError=true;_iteratorError=err;}finally{try{if(_iteratorAbruptCompletion&&_iterator.return!=null){await _iterator.return();}}finally{if(_didIteratorError){throw _iteratorError;}}}setIsTyping(false);if(!accumulatedBotText.includes(\"ERROR:\")){const sessionDocRef=doc(db,SESSIONS_COLLECTION_PATH,userId,'sessions',currentSessionId);// Update session name if it's the first message\nif(messages.length===0){const sessionName=textToSend.substring(0,30)+(textToSend.length>30?'...':'');await setDoc(sessionDocRef,{name:sessionName},{merge:true});}await saveMessage(\"bot\",accumulatedBotText);}},[input,isTyping,currentSessionId,db,userId,messages]);const startListening=useCallback(()=>{if(isTyping||!recognitionRef.current)return;setErrorMessage(null);const recognitionInstance=recognitionRef.current;// This is where we handle the result of the speech recognition\nrecognitionInstance.onresult=event=>{const transcript=event.results[0][0].transcript;setInput(transcript);recognitionInstance.stop();// Call handleSend with the transcribed text\nhandleSend(transcript);};try{recognitionInstance.start();setIsListening(true);}catch(e){if(e.name!=='InvalidStateError'){console.error(\"STT Start Error:\",e);setErrorMessage(\"Speech recognition failed to start. Browser support required.\");setIsListening(false);}}},[isTyping,handleSend,setInput,setIsListening]);// --- Render Logic ---\nif(!isAuthReady){return/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center min-h-screen text-gray-600 bg-gray-100\",children:/*#__PURE__*/_jsx(\"div\",{className:\"p-6 bg-white rounded-xl shadow-lg\",children:/*#__PURE__*/_jsx(\"p\",{children:\"Loading application and authenticating...\"})})});}// Header component\nconst Header=()=>{var _sessions$find;return/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-green-600 text-white shadow-md flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"md:hidden p-1 rounded-md hover:bg-green-700 transition\",onClick:()=>setIsSidebarOpen(!isSidebarOpen),title:\"Toggle Sidebar\",children:/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-6 w-6\",fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M4 6h16M4 12h16m-7 6h7\"})})}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-xl font-bold flex-1 text-center md:text-left\",children:\"Mene AI Chatbot\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"hidden md:block text-sm opacity-80 bg-green-700 px-3 py-1 rounded-full\",children:[\"Session: \",((_sessions$find=sessions.find(s=>s.id===currentSessionId))===null||_sessions$find===void 0?void 0:_sessions$find.name)||\"New Chat\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"hidden md:block text-xs font-mono opacity-60 ml-4\",children:[\"App ID: \",APP_ID.substring(0,8),\"...\"]})]});};// Main Chat Content\nconst chatContent=/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 flex flex-col min-w-0 bg-white\",children:[/*#__PURE__*/_jsx(Header,{}),errorMessage&&/*#__PURE__*/_jsx(\"div\",{className:\"p-3 bg-red-100 text-red-700 text-sm text-center font-medium border-l-4 border-red-500\",children:errorMessage}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 p-4 space-y-4 overflow-y-auto custom-scrollbar\",children:[messages.map(msg=>/*#__PURE__*/_jsx(\"div\",{className:\"flex \".concat(msg.sender===\"user\"?\"justify-end\":\"justify-start\"),children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-xs md:max-w-md lg:max-w-lg p-3 rounded-xl shadow-md text-sm \".concat(msg.sender===\"user\"?\"bg-blue-500 text-white rounded-br-none\":\"bg-gray-200 text-gray-800 rounded-tl-none\"),onClick:msg.sender===\"bot\"&&canSpeak?()=>handleSpeak(msg.text):null,style:msg.sender===\"bot\"&&canSpeak?{cursor:'pointer'}:{},title:msg.sender===\"bot\"&&canSpeak?\"Click to hear this message\":null,children:msg.text})},msg.id)),isTyping&&/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-start\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-xs p-3 rounded-xl bg-gray-100 text-gray-500 italic text-sm shadow-sm\",children:\"Mene is generating...\"})}),/*#__PURE__*/_jsx(\"div\",{ref:messageEndRef})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-3 border-t border-gray-200 flex items-center space-x-2 bg-gray-50\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"p-3 rounded-full transition duration-150 shadow-md \".concat(isListening?'bg-red-500 text-white animate-pulse':'bg-gray-300 text-gray-700 hover:bg-gray-400'),onClick:startListening,disabled:isTyping||!canSpeak// Disable if STT/TTS not supported\n,title:isListening?\"Listening...\":\"Start voice input (STT)\",children:/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-5 w-5\",viewBox:\"0 0 20 20\",fill:\"currentColor\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"M7 4a3 3 0 016 0v4a3 3 0 11-6 0V4z\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M5.5 9.5a.5.5 0 011 0v4a.5.5 0 01-1 0v-4zM13.5 9.5a.5.5 0 011 0v4a.5.5 0 01-1 0v-4z\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M10 18a.75.75 0 01-.75-.75V15a.75.75 0 011.5 0v2.25A.75.75 0 0110 18zm6.5-6.5a.5.5 0 01-1 0v-4a.5.5 0 011 0v4zM3.5 11.5a.5.5 0 011 0v-4a.5.5 0 01-1 0v4z\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M5 9.75a.75.75 0 01.75-.75h8.5a.75.75 0 010 1.5H5.75A.75.75 0 015 9.75z\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M15 11a1 1 0 011 1v2a4 4 0 01-8 0v-2a1 1 0 011-1h6z\"})]})}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:input,onChange:e=>setInput(e.target.value),onKeyDown:e=>{if(e.key===\"Enter\"||e.keyCode===13){e.preventDefault();handleSend();}},placeholder:\"Ask Mene anything...\",disabled:isTyping,className:\"flex-1 p-3 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-green-500 transition duration-150\"}),/*#__PURE__*/_jsx(\"button\",{className:\"p-3 rounded-full transition duration-150 shadow-md \".concat(canSpeak&&!isTyping&&lastBotMessage?'bg-green-500 text-white hover:bg-green-600':'bg-gray-300 text-gray-500 cursor-not-allowed'),onClick:()=>handleSpeak(lastBotMessage===null||lastBotMessage===void 0?void 0:lastBotMessage.text),disabled:isTyping||!canSpeak||!lastBotMessage,title:\"Read last bot message aloud (TTS)\",children:/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-5 w-5\",viewBox:\"0 0 20 20\",fill:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M9.383 3.003c.125-.466.52-.803.955-.803h.305c.435 0 .83.337.955.803l.36 1.353a1.5 1.5 0 001.037.989l.254.053c1.685.356 2.5 1.776 2.5 3.328v2.96c0 1.552-.815 2.972-2.5 3.328l-.254.053a1.5 1.5 0 00-1.037.989l-.36 1.353c-.125.466-.52.803-.955.803h-.305c-.435 0-.83-.337-.955.803l-.36-1.353a1.5 1.5 0 00-1.037-.989l-.254-.053c-1.685-.356-2.5-1.776-2.5-3.328v-2.96c0-1.552.815-2.972 2.5-3.328l.254-.053a1.5 1.5 0 001.037-.989l.36-1.353zM10 7a1 1 0 100 2 1 1 0 000-2zm0 4a1 1 0 100 2 1 1 0 000-2z\"})})}),/*#__PURE__*/_jsx(\"button\",{className:\"p-3 rounded-full transition duration-150 shadow-md \".concat(isTyping||!input.trim()?'bg-gray-300 text-gray-500 cursor-not-allowed':'bg-green-500 text-white hover:bg-green-600'),onClick:()=>handleSend(),disabled:isTyping||!input.trim(),title:\"Send Message\",children:/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-5 w-5\",viewBox:\"0 0 20 20\",fill:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l4.47-1.405 6.447 3.376a1 1 0 00.999 0l6.447-3.376 4.47 1.405a1 1 0 001.169-1.409l-7-14z\"})})})]})]});// Final Application Layout (Desktop/Mobile Responsive)\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col min-h-screen w-full bg-gray-100 font-inter\",children:[/*#__PURE__*/_jsx(\"script\",{src:\"https://cdn.tailwindcss.com\"}),/*#__PURE__*/_jsx(\"style\",{children:\"\\n                            html, body, #root {\\n                height: 100%;\\n                margin: 0;\\n                padding: 0;\\n            }\\n\\n                    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');\\n                    body { font-family: 'Inter', sans-serif; }\\n                    .custom-scrollbar::-webkit-scrollbar { width: 8px; }\\n                    .custom-scrollbar::-webkit-scrollbar-track { background: #f1f1f1; }\\n                    .custom-scrollbar::-webkit-scrollbar-thumb { background: #ccc; border-radius: 10px; }\\n                    .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #999; }\\n                \"}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-full h-screen md:w-full md:max-w-6xl md:h-[90vh] flex bg-white md:rounded-xl shadow-2xl overflow-hidden transition-all duration-300\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"fixed inset-0 z-40 md:static md:z-auto \".concat(isSidebarOpen?'translate-x-0':'-translate-x-full',\" md:translate-x-0 transition-transform duration-300 w-64 flex-shrink-0\"),children:[/*#__PURE__*/_jsx(Sidebar,{sessions:sessions,currentSessionId:currentSessionId,switchSession:switchSession,createNewSession:createSession,deleteSession:deleteSession,userId:userId}),isSidebarOpen&&window.innerWidth<768&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 bg-black opacity-50 md:hidden z-30\",onClick:()=>setIsSidebarOpen(false)})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 flex flex-col min-w-0 z-10\",children:chatContent})]})]});}","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","v4","uuidv4","initializeApp","getAuth","signInAnonymously","onAuthStateChanged","getFirestore","collection","query","onSnapshot","addDoc","orderBy","limit","serverTimestamp","setLogLevel","doc","deleteDoc","writeBatch","getDocs","setDoc","jsx","_jsx","jsxs","_jsxs","FIREBASE_CONFIG","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","APP_ID","GEMINI_API_KEY","MODEL_NAME","API_ENDPOINT","concat","TTS_API_ENDPOINT","askAIStream","inputText","chatHistory","fullResponse","chunks","chunkIndex","historyForAPI","map","msg","role","sender","parts","text","next","_data$candidates","_data$candidates$","_data$candidates$$con","_data$candidates$$con2","_data$candidates$$con3","payload","contents","systemInstruction","response","fetch","method","headers","body","JSON","stringify","ok","_errorDetails$error","errorDetails","json","Error","status","statusText","error","message","data","candidates","content","split","filter","c","length","done","value","Promise","r","setTimeout","chunk","console","Symbol","asyncIterator","base64ToArrayBuffer","base64","binaryString","atob","len","bytes","Uint8Array","i","charCodeAt","buffer","writeString","view","offset","string","setUint8","pcmToWav","pcm16","sampleRate","numChannels","numSamples","byteRate","blockAlign","ArrayBuffer","byteLength","DataView","setUint32","setUint16","pcmView","Int16Array","set","Blob","type","ttsApiCall","setErrorMessage","_result$candidates","_result$candidates$","_result$candidates$$c","_result$candidates$$c2","_part$inlineData","_part$inlineData2","generationConfig","responseModalities","speechConfig","voiceConfig","prebuiltVoiceConfig","voiceName","result","part","audioData","inlineData","mimeType","startsWith","rateMatch","match","parseInt","pcmData","wavBlob","URL","createObjectURL","SESSIONS_COLLECTION_PATH","MESSAGES_COLLECTION_PATH","userId","sessionId","Sidebar","memo","_ref","sessions","currentSessionId","switchSession","createNewSession","deleteSession","displayUserId","substring","className","children","onClick","title","xmlns","viewBox","fill","fillRule","d","clipRule","session","id","name","e","stopPropagation","App","db","setDb","auth","setAuth","setUserId","isAuthReady","setIsAuthReady","setSessions","setCurrentSessionId","messages","setMessages","input","setInput","isTyping","setIsTyping","errorMessage","messageEndRef","isSidebarOpen","setIsSidebarOpen","window","innerWidth","canSpeak","setCanSpeak","isListening","setIsListening","lastBotMessage","setLastBotMessage","recognitionRef","app","firestore","authentication","unsubscribeAuth","user","_authentication$curre","log","currentUser","uid","crypto","randomUUID","createSession","userSessionsRef","newDocRef","placeholderName","createdAt","q","unsubscribe","snapshot","loadedSessions","docs","_objectSpread","find","s","messagesRef","loadedMessages","_data$createdAt","toDate","Date","lastBot","slice","reverse","_messageEndRef$curren","current","scrollIntoView","behavior","recognitionInstance","webkitSpeechRecognition","continuous","interimResults","lang","onend","onerror","event","stop","confirm","sessionDocRef","batch","messageDocs","forEach","msgDoc","delete","ref","commit","remainingSessions","handleSpeak","audioUrl","audio","Audio","play","saveMessage","handleSend","transcript","arguments","undefined","textToSend","trim","accumulatedBotText","historyForAI","stream","tempBotId","prev","_iteratorAbruptCompletion","_didIteratorError","_iteratorError","_iterator","_asyncIterator","_step","includes","err","return","sessionName","merge","startListening","onresult","results","start","Header","_sessions$find","stroke","strokeLinecap","strokeLinejoin","strokeWidth","chatContent","style","cursor","disabled","onChange","target","onKeyDown","key","keyCode","preventDefault","placeholder","src"],"sources":["/workspaces/MeneBot-/src/App.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback } from \"react\";\nimport { v4 as uuidv4 } from 'uuid';\nimport { \n    initializeApp \n} from 'firebase/app';\nimport { \n    getAuth, \n    signInAnonymously, \n    onAuthStateChanged,\n} from 'firebase/auth';\nimport { \n    getFirestore, \n    collection, \n    query, \n    onSnapshot, \n    addDoc, \n    orderBy,\n    limit,\n    serverTimestamp,\n    setLogLevel,\n    doc,\n    deleteDoc,\n    writeBatch,\n    getDocs,\n    setDoc\n} from 'firebase/firestore';\n\n\n// --- CONFIGURATION FOR GITHUB DEPLOYMENT ---\n// This configuration is hardcoded as environment variables are not available on GitHub Pages.\nconst FIREBASE_CONFIG = {\n    apiKey: \"AIzaSyACbU7QPgmUkvn1cmIIytlUK8FI0xBHhmE\",\n    authDomain: \"mene-bot.firebaseapp.com\",\n    projectId: \"mene-bot\",\n    storageBucket: \"mene-bot.firebasestorage.app\",\n    messagingSenderId: \"535679609146\",\n    appId: \"1:535679609146:web:750fcd7b478d93bcae8803\",\n    measurementId: \"G-Q7ET9SGXB8\"\n};\n\n// Use the Firebase Project ID as the logical application identifier for Firestore paths\nconst APP_ID = FIREBASE_CONFIG.projectId;\n\n// Use the API key provided in the original fallback\nconst GEMINI_API_KEY = 'AIzaSyD0fDB4XPYTSONxvbLTUCLznwzLWWV11ys'; \n\n// --- API and TTS/STT Helper Functions ---\nconst MODEL_NAME = 'gemini-2.5-flash-preview-09-2025';\nconst API_ENDPOINT = `https://generativelanguage.googleapis.com/v1beta/models/${MODEL_NAME}:generateContent?key=${GEMINI_API_KEY}`;\nconst TTS_API_ENDPOINT = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-tts:generateContent?key=${GEMINI_API_KEY}`;\n\n\n/**\n * Creates an Async Iterator that handles the AI request and simulates a stream.\n */\nfunction askAIStream(inputText, chatHistory) {\n    let fullResponse = null;\n    let chunks = [];\n    let chunkIndex = 0;\n\n    const historyForAPI = chatHistory.map(msg => ({\n        role: msg.sender === 'user' ? 'user' : 'model',\n        parts: [{ text: msg.text }],\n    }));\n\n    // Manually implements the async iterator protocol\n    return {\n        async next() {\n            try {\n                // First call: make the REST API request\n                if (fullResponse === null) {\n                    const payload = {\n                        contents: [...historyForAPI, { role: 'user', parts: [{ text: inputText }] }],\n                        systemInstruction: { parts: [{ text: \"You are Mene, a helpful and friendly AI assistant. Keep your responses concise.\" }] },\n                    };\n\n                    const response = await fetch(API_ENDPOINT, {\n                        method: 'POST',\n                        headers: { 'Content-Type': 'application/json' },\n                        body: JSON.stringify(payload)\n                    });\n\n                    if (!response.ok) {\n                        const errorDetails = await response.json();\n                        throw new Error(`${response.status} ${response.statusText}: ${errorDetails.error?.message || 'Unknown API Error'}`); \n                    }\n                    \n                    const data = await response.json();\n                    \n                    fullResponse = data.candidates?.[0]?.content?.parts?.[0]?.text || \"No response received from AI.\";\n                    \n                    // Split the full response to simulate the streaming effect\n                    chunks = fullResponse.split(/(\\s+)/).filter(c => c.length > 0); \n                }\n\n                // Subsequent calls: Stream out the chunks one by one\n                if (chunkIndex >= chunks.length) {\n                    return { done: true, value: fullResponse }; \n                }\n\n                await new Promise((r) => setTimeout(r, 0));\n\n\n                const chunk = chunks[chunkIndex++];\n                return { value: chunk, done: false };\n\n            } catch (error) {\n                console.error(\"Gemini API Error:\", error);\n                return { value: `ERROR: Failed to connect to AI. Details: ${error.message}`, done: true };\n            }\n        },\n        [Symbol.asyncIterator]() {\n            return this;\n        }\n    };\n}\n\n\n/**\n * Converts a base64 string to an ArrayBuffer.\n */\nconst base64ToArrayBuffer = (base64) => {\n    const binaryString = atob(base64);\n    const len = binaryString.length;\n    const bytes = new Uint8Array(len);\n    for (let i = 0; i < len; i++) {\n        bytes[i] = binaryString.charCodeAt(i);\n    }\n    return bytes.buffer;\n};\n\n/**\n * Writes a string to a DataView at a specified offset.\n */\nconst writeString = (view, offset, string) => {\n    for (let i = 0; i < string.length; i++) {\n        view.setUint8(offset + i, string.charCodeAt(i));\n    }\n};\n\n/**\n * Converts PCM (raw audio data) to a standard WAV format Blob.\n */\nconst pcmToWav = (pcm16, sampleRate) => {\n    const numChannels = 1;\n    const numSamples = pcm16.length;\n    const byteRate = sampleRate * numChannels * 2; \n    const blockAlign = numChannels * 2;\n\n    const buffer = new ArrayBuffer(44 + pcm16.byteLength);\n    const view = new DataView(buffer);\n\n    // RIFF header\n    writeString(view, 0, 'RIFF');\n    view.setUint32(4, 36 + pcm16.byteLength, true);\n    writeString(view, 8, 'WAVE');\n    \n    // fmt sub-chunk\n    writeString(view, 12, 'fmt ');\n    view.setUint32(16, 16, true);\n    view.setUint16(20, 1, true); // Audio format 1 (PCM)\n    view.setUint16(22, numChannels, true);\n    view.setUint32(24, sampleRate, true);\n    view.setUint32(28, byteRate, true);\n    view.setUint16(32, blockAlign, true);\n    view.setUint16(34, 16, true); // Bits per sample\n    \n    // data sub-chunk\n    writeString(view, 36, 'data');\n    view.setUint32(40, pcm16.byteLength, true);\n\n    // PCM data\n    const pcmView = new Int16Array(buffer, 44);\n    pcmView.set(pcm16);\n\n    return new Blob([buffer], { type: 'audio/wav' });\n};\n\n/**\n * Makes the TTS API call and returns an Audio URL.\n */\nconst ttsApiCall = async (text, setErrorMessage) => {\n    if (!text) return null;\n\n    try {\n        const payload = {\n            contents: [{ parts: [{ text: text }] }],\n            generationConfig: {\n                responseModalities: [\"AUDIO\"],\n                speechConfig: {\n                    voiceConfig: {\n                        prebuiltVoiceConfig: { voiceName: \"Achird\" } \n                    }\n                }\n            }\n        };\n\n        const response = await fetch(TTS_API_ENDPOINT, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify(payload)\n        });\n\n        if (!response.ok) {\n            throw new Error(`TTS API failed with status ${response.status}`);\n        }\n\n        const result = await response.json();\n        const part = result?.candidates?.[0]?.content?.parts?.[0];\n        const audioData = part?.inlineData?.data;\n        const mimeType = part?.inlineData?.mimeType;\n\n        if (audioData && mimeType && mimeType.startsWith(\"audio/L16\")) {\n            const rateMatch = mimeType.match(/rate=(\\d+)/);\n            const sampleRate = rateMatch ? parseInt(rateMatch[1], 10) : 24000; \n\n            const pcmData = base64ToArrayBuffer(audioData);\n            const pcm16 = new Int16Array(pcmData);\n            const wavBlob = pcmToWav(pcm16, sampleRate);\n            return URL.createObjectURL(wavBlob);\n        } else {\n            setErrorMessage(\"TTS Error: Could not generate valid audio data.\");\n            return null;\n        }\n\n    } catch (error) {\n        console.error(\"TTS Fetch Error:\", error);\n        setErrorMessage(`TTS Generation failed: ${error.message}`);\n        return null;\n    }\n};\n\n// --- Firestore Collection Paths (using private user data model) ---\nconst SESSIONS_COLLECTION_PATH = `/artifacts/${APP_ID}/users`;\nconst MESSAGES_COLLECTION_PATH = (userId, sessionId) => \n    `/artifacts/${APP_ID}/users/${userId}/sessions/${sessionId}/messages`;\n\n\n// --- UI Components (Defined locally for single-file mandate) ---\n\nconst Sidebar = React.memo(({ sessions, currentSessionId, switchSession, createNewSession, deleteSession, userId }) => {\n    const displayUserId = userId ? `${userId.substring(0, 8)}...` : \"N/A\";\n    \n    return (\n        <div className=\"w-full md:w-64 bg-gray-50 border-r border-gray-200 p-4 flex flex-col transition-all duration-300\">\n            <h2 className=\"text-xl font-bold text-gray-800 mb-4 flex items-center justify-between\">\n                Conversations\n                <button\n                    onClick={createNewSession}\n                    className=\"p-2 bg-green-500 text-white rounded-full hover:bg-green-600 transition duration-150 shadow-md\"\n                    title=\"New Chat\"\n                >\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                        <path fillRule=\"evenodd\" d=\"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z\" clipRule=\"evenodd\" />\n                    </svg>\n                </button>\n            </h2>\n\n            <div className=\"flex-1 overflow-y-auto space-y-2\">\n                {sessions.map((session) => (\n                    <div\n                        key={session.id}\n                        className={`flex items-center justify-between p-3 rounded-lg cursor-pointer transition duration-150 ${session.id === currentSessionId ? 'bg-green-100 text-green-700 font-semibold' : 'bg-white text-gray-700 hover:bg-gray-100'}`}\n                        onClick={() => switchSession(session.id)}\n                    >\n                        <span className=\"truncate flex-1\">{session.name || \"New Chat\"}</span>\n                        <button\n                            onClick={(e) => { e.stopPropagation(); deleteSession(session.id); }}\n                            className=\"text-red-500 p-1 hover:text-red-700 rounded-full transition duration-150 ml-2\"\n                            title=\"Delete Chat\"\n                        >\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                                <path fillRule=\"evenodd\" d=\"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 100 2v6a1 1 0 100-2V8z\" clipRule=\"evenodd\" />\n                            </svg>\n                        </button>\n                    </div>\n                ))}\n            </div>\n            <div className=\"mt-4 pt-4 border-t border-gray-200 text-sm text-gray-500\">\n                User ID: <span className=\"font-mono text-xs\">{displayUserId}</span>\n            </div>\n        </div>\n    );\n});\n\n\n// --- Main App Component ---\n\nexport default function App() {\n    // --- Firebase State ---\n    const [db, setDb] = useState(null);\n    const [auth, setAuth] = useState(null);\n    const [userId, setUserId] = useState(null);\n    const [isAuthReady, setIsAuthReady] = useState(false);\n    const [sessions, setSessions] = useState([]);\n    const [currentSessionId, setCurrentSessionId] = useState(null);\n\n    // --- Chat State ---\n    const [messages, setMessages] = useState([]);\n    const [input, setInput] = useState(\"\");\n    const [isTyping, setIsTyping] = useState(false);\n    const [errorMessage, setErrorMessage] = useState(null);\n    const messageEndRef = useRef(null);\n    const [isSidebarOpen, setIsSidebarOpen] = useState(window.innerWidth >= 768); \n\n    // --- TTS/STT State ---\n    const [canSpeak, setCanSpeak] = useState(false);\n    const [isListening, setIsListening] = useState(false); \n    const [lastBotMessage, setLastBotMessage] = useState(null);\n    const recognitionRef = useRef(null); \n\n\n    // 1. Initialize Firebase and Authentication\n    useEffect(() => {\n        try {\n            const app = initializeApp(FIREBASE_CONFIG);\n            const firestore = getFirestore(app);\n            const authentication = getAuth(app);\n\n            setLogLevel('debug'); \n            setDb(firestore);\n            setAuth(authentication);\n\n            const unsubscribeAuth = onAuthStateChanged(authentication, async (user) => {\n                if (!user) {\n                    console.log(\"No user signed in. Attempting anonymous sign-in...\");\n                    try {\n                        // Use anonymous sign-in for GitHub Pages deployment\n                        await signInAnonymously(authentication);\n                    } catch (e) {\n                        console.error(\"Firebase Auth Error:\", e);\n                        setErrorMessage(\"Failed to authenticate with Firebase.\");\n                    }\n                }\n                setUserId(authentication.currentUser?.uid || crypto.randomUUID());\n                setIsAuthReady(true);\n            });\n\n            return () => unsubscribeAuth();\n        } catch (e) {\n            console.error(\"Firebase Init Error:\", e);\n            setErrorMessage(\"Failed to initialize Firebase services.\");\n        }\n    }, []); // Empty dependency array, runs once\n\n\n    // 2. Setup Sessions Listener\n    const createSession = useCallback(async () => {\n        if (!db || !userId) return;\n\n        try {\n            const userSessionsRef = collection(db, SESSIONS_COLLECTION_PATH, userId, 'sessions');\n            const newDocRef = doc(userSessionsRef);\n            \n            const placeholderName = `Chat ${sessions.length + 1}`; \n\n            await setDoc(newDocRef, {\n                name: placeholderName,\n                createdAt: serverTimestamp(),\n            });\n\n            setCurrentSessionId(newDocRef.id);\n            if (window.innerWidth < 768) {\n                setIsSidebarOpen(false); \n            }\n        } catch (e) {\n            console.error(\"Error creating new session:\", e);\n            setErrorMessage(\"Failed to create a new session.\");\n        }\n    }, [db, userId, sessions.length]);\n\n    useEffect(() => {\n        if (!isAuthReady || !db || !userId) return;\n\n        const userSessionsRef = collection(db, SESSIONS_COLLECTION_PATH, userId, 'sessions');\n        const q = query(userSessionsRef, orderBy('createdAt', 'desc'));\n\n        const unsubscribe = onSnapshot(q, (snapshot) => {\n            const loadedSessions = snapshot.docs.map(doc => ({\n                id: doc.id,\n                ...doc.data()\n            }));\n\n            setSessions(loadedSessions);\n\n            if (loadedSessions.length === 0) {\n                setTimeout(() => createSession(), 0); \n            } else if (!currentSessionId || !loadedSessions.find(s => s.id === currentSessionId)) {\n                setCurrentSessionId(loadedSessions[0].id);\n            }\n        }, (error) => {\n            console.error(\"Firestore Sessions Error:\", error);\n            setErrorMessage(\"Failed to fetch chat sessions.\");\n        });\n\n        return () => unsubscribe();\n    }, [isAuthReady, db, userId, currentSessionId, createSession]);\n\n\n    // 3. Setup Messages Listener (Current Session)\n    useEffect(() => {\n        if (!isAuthReady || !db || !userId || !currentSessionId) {\n            setMessages([]); \n            return;\n        }\n\n        const messagesRef = collection(db, MESSAGES_COLLECTION_PATH(userId, currentSessionId));\n        const q = query(messagesRef, orderBy('createdAt', 'asc'), limit(50));\n\n        const unsubscribe = onSnapshot(q, (snapshot) => {\n            const loadedMessages = snapshot.docs.map(doc => {\n                const data = doc.data();\n                return {\n                    id: doc.id,\n                    sender: data.sender,\n                    text: data.text,\n                    createdAt: data.createdAt?.toDate ? data.createdAt.toDate() : new Date(),\n                };\n            });\n            setMessages(loadedMessages);\n\n            const lastBot = loadedMessages.slice().reverse().find(msg => msg.sender === 'bot');\n            setLastBotMessage(lastBot);\n\n        }, (error) => {\n            console.error(\"Firestore Messages Error:\", error);\n            setErrorMessage(\"Failed to fetch chat messages.\");\n        });\n\n        return () => unsubscribe();\n    }, [isAuthReady, db, userId, currentSessionId]);\n\n\n    // 4. Scroll to bottom on new messages/typing\n    useEffect(() => {\n        messageEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n    }, [messages, isTyping]);\n\n\n    // 5. Check for TTS/STT capability and setup STT\n    useEffect(() => {\n        if ('speechSynthesis' in window && 'webkitSpeechRecognition' in window) {\n            setCanSpeak(true);\n        }\n\n        if ('webkitSpeechRecognition' in window) {\n            const recognitionInstance = new window.webkitSpeechRecognition();\n            recognitionInstance.continuous = false;\n            recognitionInstance.interimResults = false;\n            recognitionInstance.lang = 'en-US';\n            \n            recognitionInstance.onend = () => setIsListening(false);\n            recognitionInstance.onerror = (event) => {\n                console.error('Speech recognition error:', event.error);\n                setErrorMessage(`Speech recognition error: ${event.error}`);\n                setIsListening(false);\n            };\n\n            recognitionRef.current = recognitionInstance;\n        }\n\n        return () => {\n            if (recognitionRef.current) {\n                recognitionRef.current.stop();\n                recognitionRef.current = null;\n            }\n        };\n    }, []);\n\n    // --- Firebase Actions ---\n\n    const switchSession = useCallback((sessionId) => {\n        setCurrentSessionId(sessionId);\n        if (window.innerWidth < 768) {\n            setIsSidebarOpen(false); \n        }\n    }, []);\n\n    const deleteSession = async (sessionId) => {\n        if (!db || !userId) return;\n\n        // Use a custom UI component for confirmation instead of window.confirm\n        if (!window.confirm(\"Are you sure you want to delete this chat session and all its messages?\")) {\n            return;\n        }\n\n        try {\n            const sessionDocRef = doc(db, SESSIONS_COLLECTION_PATH, userId, 'sessions', sessionId);\n            const messagesRef = collection(db, MESSAGES_COLLECTION_PATH(userId, sessionId));\n            \n            const batch = writeBatch(db);\n\n            const messageDocs = await getDocs(messagesRef);\n            messageDocs.forEach(msgDoc => {\n                batch.delete(msgDoc.ref);\n            });\n            \n            batch.delete(sessionDocRef);\n\n            await batch.commit();\n\n            // Logic to switch to a new session after deletion\n            if (currentSessionId === sessionId) {\n                const remainingSessions = sessions.filter(s => s.id !== sessionId);\n                if (remainingSessions.length > 0) {\n                    setCurrentSessionId(remainingSessions[0].id);\n                } else {\n                    setCurrentSessionId(null);\n                    setTimeout(() => createSession(), 100); \n                }\n            }\n        } catch (e) {\n            console.error(\"Error deleting session:\", e);\n            setErrorMessage(\"Failed to delete the chat session.\");\n        }\n    };\n    \n    // --- TTS/STT Handlers ---\n\n    const handleSpeak = useCallback(async (text) => {\n        if (!canSpeak || !text) return;\n\n        setErrorMessage(null);\n\n        const audioUrl = await ttsApiCall(text, setErrorMessage);\n        if (audioUrl) {\n            const audio = new Audio(audioUrl);\n            audio.play();\n        }\n    }, [canSpeak]);\n\n    const saveMessage = async (sender, text) => {\n        if (!db || !userId || !currentSessionId || !text) return;\n\n        try {\n            const messagesRef = collection(db, MESSAGES_COLLECTION_PATH(userId, currentSessionId));\n            await addDoc(messagesRef, {\n                sender: sender,\n                text: text,\n                createdAt: serverTimestamp(),\n            });\n        } catch (e) {\n            console.error(\"Error saving message:\", e);\n            setErrorMessage(\"Failed to save message to database.\");\n        }\n    };\n\n    const handleSend = useCallback(async (transcript = null) => {\n        const textToSend = (transcript || input).trim();\n        if (isTyping || !textToSend || !currentSessionId) return;\n\n        setErrorMessage(null);\n        setIsTyping(true);\n        setInput(\"\");\n\n        await saveMessage(\"user\", textToSend);\n\n        let accumulatedBotText = \"\";\n        const historyForAI = messages.map(msg => ({ sender: msg.sender, text: msg.text })); \n        const stream = askAIStream(textToSend, historyForAI);\n\n        const tempBotId = uuidv4();\n        // Add a temporary message placeholder to trigger scroll and show typing state\n        setMessages(prev => [...prev, { id: tempBotId, sender: \"bot\", text: \"\" }]);\n\n        for await (const chunk of stream) {\n            accumulatedBotText += chunk;\n\n            setMessages(prev => \n                prev.map(msg => \n                    msg.id === tempBotId ? { ...msg, text: accumulatedBotText } : msg\n                )\n            );\n\n            if (accumulatedBotText.includes(\"ERROR:\")) break;\n        }\n\n        setIsTyping(false);\n\n        if (!accumulatedBotText.includes(\"ERROR:\")) {\n            const sessionDocRef = doc(db, SESSIONS_COLLECTION_PATH, userId, 'sessions', currentSessionId);\n\n            // Update session name if it's the first message\n            if (messages.length === 0) {\n                const sessionName = textToSend.substring(0, 30) + (textToSend.length > 30 ? '...' : '');\n                await setDoc(sessionDocRef, { name: sessionName }, { merge: true });\n            }\n            \n            await saveMessage(\"bot\", accumulatedBotText);\n            \n        } \n\n    }, [input, isTyping, currentSessionId, db, userId, messages]);\n\n\n    const startListening = useCallback(() => {\n        if (isTyping || !recognitionRef.current) return;\n        \n        setErrorMessage(null);\n        \n        const recognitionInstance = recognitionRef.current;\n        \n        // This is where we handle the result of the speech recognition\n        recognitionInstance.onresult = (event) => {\n            const transcript = event.results[0][0].transcript;\n            setInput(transcript);\n            recognitionInstance.stop(); \n            // Call handleSend with the transcribed text\n            handleSend(transcript); \n        };\n\n        try {\n            recognitionInstance.start();\n            setIsListening(true);\n        } catch (e) {\n            if (e.name !== 'InvalidStateError') { \n                console.error(\"STT Start Error:\", e);\n                setErrorMessage(\"Speech recognition failed to start. Browser support required.\");\n                setIsListening(false);\n            }\n        }\n    }, [isTyping, handleSend, setInput, setIsListening]); \n\n\n    // --- Render Logic ---\n    if (!isAuthReady) {\n        return (\n            <div className=\"flex justify-center items-center min-h-screen text-gray-600 bg-gray-100\">\n                <div className=\"p-6 bg-white rounded-xl shadow-lg\">\n                    <p>Loading application and authenticating...</p>\n                </div>\n            </div>\n        );\n    }\n    \n    // Header component\n    const Header = () => (\n        <div className=\"p-4 bg-green-600 text-white shadow-md flex items-center justify-between\">\n            <button \n                className=\"md:hidden p-1 rounded-md hover:bg-green-700 transition\"\n                onClick={() => setIsSidebarOpen(!isSidebarOpen)}\n                title=\"Toggle Sidebar\"\n            >\n                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-6 w-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 6h16M4 12h16m-7 6h7\" />\n                </svg>\n            </button>\n            <h1 className=\"text-xl font-bold flex-1 text-center md:text-left\">\n                Mene AI Chatbot\n            </h1>\n            <span className=\"hidden md:block text-sm opacity-80 bg-green-700 px-3 py-1 rounded-full\">\n                Session: {sessions.find(s => s.id === currentSessionId)?.name || \"New Chat\"}\n            </span>\n            <div className=\"hidden md:block text-xs font-mono opacity-60 ml-4\">\n                App ID: {APP_ID.substring(0, 8)}...\n            </div>\n        </div>\n    );\n\n    // Main Chat Content\n    const chatContent = (\n        <div className=\"flex-1 flex flex-col min-w-0 bg-white\">\n            <Header />\n\n            {errorMessage && (\n                <div className=\"p-3 bg-red-100 text-red-700 text-sm text-center font-medium border-l-4 border-red-500\">\n                    {errorMessage}\n                </div>\n            )}\n\n            <div className=\"flex-1 p-4 space-y-4 overflow-y-auto custom-scrollbar\">\n                {messages.map((msg) => (\n                    <div \n                        key={msg.id} \n                        className={`flex ${msg.sender === \"user\" ? \"justify-end\" : \"justify-start\"}`}\n                    >\n                        <div\n                            className={`max-w-xs md:max-w-md lg:max-w-lg p-3 rounded-xl shadow-md text-sm ${\n                                msg.sender === \"user\"\n                                    ? \"bg-blue-500 text-white rounded-br-none\"\n                                    : \"bg-gray-200 text-gray-800 rounded-tl-none\"\n                            }`}\n                            onClick={msg.sender === \"bot\" && canSpeak ? () => handleSpeak(msg.text) : null}\n                            style={msg.sender === \"bot\" && canSpeak ? {cursor: 'pointer'} : {}}\n                            title={msg.sender === \"bot\" && canSpeak ? \"Click to hear this message\" : null}\n                        >\n                            {msg.text}\n                        </div>\n                    </div>\n                ))}\n\n                {isTyping && (\n                    <div className=\"flex justify-start\">\n                        <div className=\"max-w-xs p-3 rounded-xl bg-gray-100 text-gray-500 italic text-sm shadow-sm\">\n                            Mene is generating...\n                        </div>\n                    </div>\n                )}\n\n                <div ref={messageEndRef} />\n            </div>\n\n            {/* Input Area */}\n            <div className=\"p-3 border-t border-gray-200 flex items-center space-x-2 bg-gray-50\">\n                {/* STT Button */}\n                <button \n                    className={`p-3 rounded-full transition duration-150 shadow-md ${\n                        isListening \n                            ? 'bg-red-500 text-white animate-pulse' \n                            : 'bg-gray-300 text-gray-700 hover:bg-gray-400'\n                    }`}\n                    onClick={startListening}\n                    disabled={isTyping || !canSpeak} // Disable if STT/TTS not supported\n                    title={isListening ? \"Listening...\" : \"Start voice input (STT)\"}\n                >\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                        <path d=\"M7 4a3 3 0 016 0v4a3 3 0 11-6 0V4z\" />\n                        <path d=\"M5.5 9.5a.5.5 0 011 0v4a.5.5 0 01-1 0v-4zM13.5 9.5a.5.5 0 011 0v4a.5.5 0 01-1 0v-4z\" />\n                        <path d=\"M10 18a.75.75 0 01-.75-.75V15a.75.75 0 011.5 0v2.25A.75.75 0 0110 18zm6.5-6.5a.5.5 0 01-1 0v-4a.5.5 0 011 0v4zM3.5 11.5a.5.5 0 011 0v-4a.5.5 0 01-1 0v4z\" />\n                        <path d=\"M5 9.75a.75.75 0 01.75-.75h8.5a.75.75 0 010 1.5H5.75A.75.75 0 015 9.75z\" />\n                        <path d=\"M15 11a1 1 0 011 1v2a4 4 0 01-8 0v-2a1 1 0 011-1h6z\" />\n                    </svg>\n                </button>\n\n                {/* Text Input */}\n                    <input\n            type=\"text\"\n            value={input}\n            onChange={(e) => setInput(e.target.value)}\n            onKeyDown={(e) => {\n                if (e.key === \"Enter\" || e.keyCode === 13) {\n                    e.preventDefault();\n                    handleSend();\n                }\n            }}\n            placeholder=\"Ask Mene anything...\"\n            disabled={isTyping}\n            className=\"flex-1 p-3 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-green-500 transition duration-150\"\n        />\n\n                {/* TTS Button */}\n                <button \n                    className={`p-3 rounded-full transition duration-150 shadow-md ${\n                        canSpeak && !isTyping && lastBotMessage\n                            ? 'bg-green-500 text-white hover:bg-green-600'\n                            : 'bg-gray-300 text-gray-500 cursor-not-allowed'\n                    }`}\n                    onClick={() => handleSpeak(lastBotMessage?.text)}\n                    disabled={isTyping || !canSpeak || !lastBotMessage}\n                    title=\"Read last bot message aloud (TTS)\"\n                >\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                        <path d=\"M9.383 3.003c.125-.466.52-.803.955-.803h.305c.435 0 .83.337.955.803l.36 1.353a1.5 1.5 0 001.037.989l.254.053c1.685.356 2.5 1.776 2.5 3.328v2.96c0 1.552-.815 2.972-2.5 3.328l-.254.053a1.5 1.5 0 00-1.037.989l-.36 1.353c-.125.466-.52.803-.955.803h-.305c-.435 0-.83-.337-.955.803l-.36-1.353a1.5 1.5 0 00-1.037-.989l-.254-.053c-1.685-.356-2.5-1.776-2.5-3.328v-2.96c0-1.552.815-2.972 2.5-3.328l.254-.053a1.5 1.5 0 001.037-.989l.36-1.353zM10 7a1 1 0 100 2 1 1 0 000-2zm0 4a1 1 0 100 2 1 1 0 000-2z\" />\n                    </svg>\n                </button>\n\n                {/* Send Button */}\n                <button \n                    className={`p-3 rounded-full transition duration-150 shadow-md ${\n                        isTyping || !input.trim()\n                            ? 'bg-gray-300 text-gray-500 cursor-not-allowed'\n                            : 'bg-green-500 text-white hover:bg-green-600'\n                    }`}\n                    onClick={() => handleSend()} \n                    disabled={isTyping || !input.trim()}\n                    title=\"Send Message\"\n                >\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                        <path d=\"M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l4.47-1.405 6.447 3.376a1 1 0 00.999 0l6.447-3.376 4.47 1.405a1 1 0 001.169-1.409l-7-14z\" />\n                    </svg>\n                </button>\n            </div>\n        </div>\n    );\n\n    // Final Application Layout (Desktop/Mobile Responsive)\n    return (\n        <div className=\"flex flex-col min-h-screen w-full bg-gray-100 font-inter\">\n\n            {/* Tailwind CSS Script for Inter Font and General Styling */}\n            <script src=\"https://cdn.tailwindcss.com\"></script>\n            <style>\n                            {`\n                            html, body, #root {\n                height: 100%;\n                margin: 0;\n                padding: 0;\n            }\n\n                    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');\n                    body { font-family: 'Inter', sans-serif; }\n                    .custom-scrollbar::-webkit-scrollbar { width: 8px; }\n                    .custom-scrollbar::-webkit-scrollbar-track { background: #f1f1f1; }\n                    .custom-scrollbar::-webkit-scrollbar-thumb { background: #ccc; border-radius: 10px; }\n                    .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #999; }\n                `}\n            </style>\n            \n            <div className=\"w-full h-screen md:w-full md:max-w-6xl md:h-[90vh] flex bg-white md:rounded-xl shadow-2xl overflow-hidden transition-all duration-300\">\n                \n                {/* Sidebar (Conversations Menu) */}\n                <div \n                    className={`fixed inset-0 z-40 md:static md:z-auto ${isSidebarOpen ? 'translate-x-0' : '-translate-x-full'} md:translate-x-0 transition-transform duration-300 w-64 flex-shrink-0`}\n                >\n                    <Sidebar \n                        sessions={sessions}\n                        currentSessionId={currentSessionId}\n                        switchSession={switchSession}\n                        createNewSession={createSession}\n                        deleteSession={deleteSession}\n                        userId={userId}\n                    />\n                    {isSidebarOpen && window.innerWidth < 768 && (\n                        <div \n                            className=\"absolute inset-0 bg-black opacity-50 md:hidden z-30\" \n                            onClick={() => setIsSidebarOpen(false)}\n                        ></div>\n                    )}\n                </div>\n\n                {/* Main Chat Area */}\n                <div className=\"flex-1 flex flex-col min-w-0 z-10\">\n                    {chatContent}\n                </div>\n            </div>\n        </div>\n    );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}